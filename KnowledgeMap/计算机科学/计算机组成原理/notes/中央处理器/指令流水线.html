<!doctype html>
<html style='font-size:22px !important'>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>

<style type='text/css'>html {overflow-x: initial !important;}:root { --bg-color: #ffffff; --text-color: #333333; --select-text-bg-color: #B5D6FC; --select-text-font-color: auto; --monospace: "Lucida Console",Consolas,"Courier",monospace; --title-bar-height: 20px; }
.mac-os-11 { --title-bar-height: 28px; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
body { margin: 0px; padding: 0px; height: auto; inset: 0px; font-size: 1rem; line-height: 1.42857143; overflow-x: hidden; background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; tab-size: 4; background-position: inherit; background-repeat: inherit; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; word-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; padding-top: 36px; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export li, .typora-export p { white-space: pre-wrap; }
.typora-export .task-list-item input { pointer-events: none; }
@media screen and (max-width: 500px) {
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  #write { padding-left: 20px; padding-right: 20px; }
  .CodeMirror-sizer { margin-left: 0px !important; }
  .CodeMirror-gutters { display: none !important; }
}
#write li > figure:last-child { margin-bottom: 0.5rem; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; image-orientation: from-image; }
button, input, select, textarea { color: inherit; font-family: inherit; font-size: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-stretch: inherit; line-height: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; }
p { line-height: inherit; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 4; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.7); color: rgb(85, 85, 85); border-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px; }
tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 32px; }
.CodeMirror-gutters { border-right-width: 0px; background-color: inherit; }
.CodeMirror-linenumber { }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; position: relative !important; background-position: inherit; background-repeat: inherit; }
.md-fences-adv-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; background-position: 0px 0px; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li blockquote { margin: 1rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print {
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; font-variant-ligatures: no-common-ligatures; }
  #write { margin-top: 0px; padding-top: 0px; border-color: transparent !important; }
  .typora-export * { print-color-adjust: exact; }
  .typora-export #write { break-after: avoid; }
  .typora-export #write::after { height: 0px; }
  .is-mac table { break-inside: avoid; }
  .typora-export-show-outline .typora-export-sidebar { display: none; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background-color: rgb(204, 204, 204); display: block; overflow-x: hidden; }
p > .md-image:only-child:not(.md-img-error) img, p > img:only-child { display: block; margin: auto; }
#write.first-line-indent p > .md-image:only-child:not(.md-img-error) img { left: -2em; position: relative; }
p > .md-image:only-child { display: inline-block; width: 100%; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
.MathJax_ref { fill: currentcolor; }
[contenteditable="true"]:active, [contenteditable="true"]:focus, [contenteditable="false"]:active, [contenteditable="false"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); border: none; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) {
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background-color: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.6; font-family: var(--monospace); }
code { text-align: left; }
a.md-print-anchor { white-space: pre !important; border: none !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; text-shadow: initial !important; background-position: 0px 0px !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="flow"] svg, [lang="mermaid"] svg { max-width: 100%; height: auto; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom-width: 0px; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: none; }
.highlight td, .highlight tr { border: 0px; }
mark { background-color: rgb(255, 255, 0); color: rgb(0, 0, 0); }
.md-html-inline .md-plain, .md-html-inline strong, mark .md-inline-math, mark strong { color: inherit; }
.md-expand mark .md-meta { opacity: 0.3 !important; }
mark .md-meta { color: rgb(0, 0, 0); }
@media print {
  .typora-export h1, .typora-export h2, .typora-export h3, .typora-export h4, .typora-export h5, .typora-export h6 { break-inside: avoid; }
}
.md-diagram-panel .messageText { stroke: none !important; }
.md-diagram-panel .start-state { fill: var(--node-fill); }
.md-diagram-panel .edgeLabel rect { opacity: 1 !important; }
.md-fences.md-fences-math { font-size: 1em; }
.md-fences-advanced:not(.md-focus) { padding: 0px; white-space: nowrap; border: 0px; }
.md-fences-advanced:not(.md-focus) { background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; background-position: inherit; background-repeat: inherit; }
.typora-export-show-outline .typora-export-content { max-width: 1440px; margin: auto; display: flex; flex-direction: row; }
.typora-export-sidebar { width: 300px; font-size: 0.8rem; margin-top: 80px; margin-right: 18px; }
.typora-export-show-outline #write { --webkit-flex: 2; flex: 2 1 0%; }
.typora-export-sidebar .outline-content { position: fixed; top: 0px; max-height: 100%; overflow: hidden auto; padding-bottom: 30px; padding-top: 60px; width: 300px; }
@media screen and (max-width: 1024px) {
  .typora-export-sidebar, .typora-export-sidebar .outline-content { width: 240px; }
}
@media screen and (max-width: 800px) {
  .typora-export-sidebar { display: none; }
}
.outline-content li, .outline-content ul { margin-left: 0px; margin-right: 0px; padding-left: 0px; padding-right: 0px; list-style: none; }
.outline-content ul { margin-top: 0px; margin-bottom: 0px; }
.outline-content strong { font-weight: 400; }
.outline-expander { width: 1rem; height: 1.428571429rem; position: relative; display: table-cell; vertical-align: middle; cursor: pointer; padding-left: 4px; }
.outline-expander::before { content: ""; position: relative; font-family: Ionicons; display: inline-block; font-size: 8px; vertical-align: middle; }
.outline-item { padding-top: 3px; padding-bottom: 3px; cursor: pointer; }
.outline-expander:hover::before { content: ""; }
.outline-h1 > .outline-item { padding-left: 0px; }
.outline-h2 > .outline-item { padding-left: 1em; }
.outline-h3 > .outline-item { padding-left: 2em; }
.outline-h4 > .outline-item { padding-left: 3em; }
.outline-h5 > .outline-item { padding-left: 4em; }
.outline-h6 > .outline-item { padding-left: 5em; }
.outline-label { cursor: pointer; display: table-cell; vertical-align: middle; text-decoration: none; color: inherit; }
.outline-label:hover { text-decoration: underline; }
.outline-item:hover { border-color: rgb(245, 245, 245); background-color: var(--item-hover-bg-color); }
.outline-item:hover { margin-left: -28px; margin-right: -28px; border-left-width: 28px; border-left-style: solid; border-left-color: transparent; border-right-width: 28px; border-right-style: solid; border-right-color: transparent; }
.outline-item-single .outline-expander::before, .outline-item-single .outline-expander:hover::before { display: none; }
.outline-item-open > .outline-item > .outline-expander::before { content: ""; }
.outline-children { display: none; }
.info-panel-tab-wrapper { display: none; }
.outline-item-open > .outline-children { display: block; }
.typora-export .outline-item { padding-top: 1px; padding-bottom: 1px; }
.typora-export .outline-item:hover { margin-right: -8px; border-right-width: 8px; border-right-style: solid; border-right-color: transparent; }
.typora-export .outline-expander::before { content: "+"; font-family: inherit; top: -1px; }
.typora-export .outline-expander:hover::before, .typora-export .outline-item-open > .outline-item > .outline-expander::before { content: "−"; }
.typora-export-collapse-outline .outline-children { display: none; }
.typora-export-collapse-outline .outline-item-open > .outline-children, .typora-export-no-collapse-outline .outline-children { display: block; }
.typora-export-no-collapse-outline .outline-expander::before { content: "" !important; }
.typora-export-show-outline .outline-item-active > .outline-item .outline-label { font-weight: 700; }
.md-inline-math-container mjx-container { zoom: 0.95; }


.CodeMirror { height: auto; }
.CodeMirror.cm-s-inner { background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; background-position: inherit; background-repeat: inherit; }
.CodeMirror-scroll { overflow: auto hidden; z-index: 3; }
.CodeMirror-gutter-filler, .CodeMirror-scrollbar-filler { background-color: rgb(255, 255, 255); }
.CodeMirror-gutters { border-right-width: 1px; border-right-style: solid; border-right-color: rgb(221, 221, 221); background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; white-space: nowrap; background-position: inherit; background-repeat: inherit; }
.CodeMirror-linenumber { padding: 0px 3px 0px 5px; text-align: right; color: rgb(153, 153, 153); }
.cm-s-inner .cm-keyword { color: rgb(119, 0, 136); }
.cm-s-inner .cm-atom, .cm-s-inner.cm-atom { color: rgb(34, 17, 153); }
.cm-s-inner .cm-number { color: rgb(17, 102, 68); }
.cm-s-inner .cm-def { color: rgb(0, 0, 255); }
.cm-s-inner .cm-variable { color: rgb(0, 0, 0); }
.cm-s-inner .cm-variable-2 { color: rgb(0, 85, 170); }
.cm-s-inner .cm-variable-3 { color: rgb(0, 136, 85); }
.cm-s-inner .cm-string { color: rgb(170, 17, 17); }
.cm-s-inner .cm-property { color: rgb(0, 0, 0); }
.cm-s-inner .cm-operator { color: rgb(152, 26, 26); }
.cm-s-inner .cm-comment, .cm-s-inner.cm-comment { color: rgb(170, 85, 0); }
.cm-s-inner .cm-string-2 { color: rgb(255, 85, 0); }
.cm-s-inner .cm-meta { color: rgb(85, 85, 85); }
.cm-s-inner .cm-qualifier { color: rgb(85, 85, 85); }
.cm-s-inner .cm-builtin { color: rgb(51, 0, 170); }
.cm-s-inner .cm-bracket { color: rgb(153, 153, 119); }
.cm-s-inner .cm-tag { color: rgb(17, 119, 0); }
.cm-s-inner .cm-attribute { color: rgb(0, 0, 204); }
.cm-s-inner .cm-header, .cm-s-inner.cm-header { color: rgb(0, 0, 255); }
.cm-s-inner .cm-quote, .cm-s-inner.cm-quote { color: rgb(0, 153, 0); }
.cm-s-inner .cm-hr, .cm-s-inner.cm-hr { color: rgb(153, 153, 153); }
.cm-s-inner .cm-link, .cm-s-inner.cm-link { color: rgb(0, 0, 204); }
.cm-negative { color: rgb(221, 68, 68); }
.cm-positive { color: rgb(34, 153, 34); }
.cm-header, .cm-strong { font-weight: 700; }
.cm-del { text-decoration: line-through; }
.cm-em { font-style: italic; }
.cm-link { text-decoration: underline; }
.cm-error { color: red; }
.cm-invalidchar { color: red; }
.cm-constant { color: rgb(38, 139, 210); }
.cm-defined { color: rgb(181, 137, 0); }
div.CodeMirror span.CodeMirror-matchingbracket { color: rgb(0, 255, 0); }
div.CodeMirror span.CodeMirror-nonmatchingbracket { color: rgb(255, 34, 34); }
.cm-s-inner .CodeMirror-activeline-background { background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; background-position: inherit; background-repeat: inherit; }
.CodeMirror { position: relative; overflow: hidden; }
.CodeMirror-scroll { height: 100%; outline: 0px; position: relative; box-sizing: content-box; background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; background-position: inherit; background-repeat: inherit; }
.CodeMirror-sizer { position: relative; }
.CodeMirror-gutter-filler, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-vscrollbar { position: absolute; z-index: 6; display: none; outline: 0px; }
.CodeMirror-vscrollbar { right: 0px; top: 0px; overflow: hidden; }
.CodeMirror-hscrollbar { bottom: 0px; left: 0px; overflow: auto hidden; }
.CodeMirror-scrollbar-filler { right: 0px; bottom: 0px; }
.CodeMirror-gutter-filler { left: 0px; bottom: 0px; }
.CodeMirror-gutters { position: absolute; left: 0px; top: 0px; padding-bottom: 10px; z-index: 3; overflow-y: hidden; }
.CodeMirror-gutter { white-space: normal; height: 100%; box-sizing: content-box; padding-bottom: 30px; margin-bottom: -32px; display: inline-block; }
.CodeMirror-gutter-wrapper { position: absolute; z-index: 4; border: none !important; background-position: 0px 0px !important; }
.CodeMirror-gutter-background { position: absolute; top: 0px; bottom: 0px; z-index: 4; }
.CodeMirror-gutter-elt { position: absolute; cursor: default; z-index: 4; }
.CodeMirror-lines { cursor: text; }
.CodeMirror pre { border-radius: 0px; border-width: 0px; font-family: inherit; font-size: inherit; margin: 0px; white-space: pre; word-wrap: normal; color: inherit; z-index: 2; position: relative; overflow: visible; background-position: 0px 0px; }
.CodeMirror-wrap pre { word-wrap: break-word; white-space: pre-wrap; word-break: normal; }
.CodeMirror-code pre { border-right-width: 30px; border-right-style: solid; border-right-color: transparent; width: fit-content; }
.CodeMirror-wrap .CodeMirror-code pre { border-right-style: none; width: auto; }
.CodeMirror-linebackground { position: absolute; inset: 0px; z-index: 0; }
.CodeMirror-linewidget { position: relative; z-index: 2; overflow: auto; }
.CodeMirror-wrap .CodeMirror-scroll { overflow-x: hidden; }
.CodeMirror-measure { position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden; }
.CodeMirror-measure pre { position: static; }
.CodeMirror div.CodeMirror-cursor { position: absolute; visibility: hidden; border-right-style: none; width: 0px; }
.CodeMirror div.CodeMirror-cursor { visibility: hidden; }
.CodeMirror-focused div.CodeMirror-cursor { visibility: inherit; }
.cm-searching { background-color: rgba(255, 255, 0, 0.4); }
span.cm-underlined { text-decoration: underline; }
span.cm-strikethrough { text-decoration: line-through; }
.cm-tw-syntaxerror { color: rgb(255, 255, 255); background-color: rgb(153, 0, 0); }
.cm-tw-deleted { text-decoration: line-through; }
.cm-tw-header5 { font-weight: 700; }
.cm-tw-listitem:first-child { padding-left: 10px; }
.cm-tw-box { border-style: solid; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-color: inherit; border-top-width: 0px !important; }
.cm-tw-underline { text-decoration: underline; }
@media print {
  .CodeMirror div.CodeMirror-cursor { visibility: hidden; }
}


html {
  font-size: 16px;
}

html,
body {
  font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", Helvetica, "PingFang SC", "Microsoft YaHei", sans-serif;
  text-align: justify;
  overflow-x: hidden;
  color: #282c34;
  background-color: #fefefe;
  -webkit-font-smoothing: antialiased;
}

content #write {
  background-color: #fefefe;
  max-width: 90%;
  margin: 0 auto;
  padding-bottom: 7.5rem;
}

content #write p {
  word-spacing: 0.05rem;
}

content #write ol li {
  padding-left: 0.5rem;
}

content #write > h1:first-child {
  font-weight: normal;
}

content #write > h5.md-focus:before {
  top: 2px;
}

::-moz-selection {
  background-color: #bac6e9;
}

::selection {
  background-color: #bac6e9;
}

/* h1-h3 */
#write h1,
#write h2,
#write h3 {
  font-style: normal;
}

#write h1,
#write h2 {
  text-align: center;
  margin-top: 2rem;
  margin-bottom: 1rem;
}

#write h1 {
  font-size: 3rem;
}

#write h2 {
  font-size: 2.4rem;
}

#write h2:after {
  content: "";
  display: block;
  width: 6.25rem;
  height: 1px;
  margin: 0 auto;
  border-bottom: 1px solid #2f2f2f;
}

#write h3 {
  font-size: 1.8rem;
}

/* paragraph */
p {
  margin-top: 0;
  margin-bottom: 0.5rem;
}

/* ul ol */
ul,
ol {
  padding-left: 1.75rem;
}

ul:first-child,
ol:first-child {
  margin-top: 0;
}

ul:last-child,
ol:last-child {
  margin-bottom: 0;
}

/* blockquote */
blockquote {
  padding: 0.5rem 1rem;
  border-left: 8px solid #2f845e;
  background-color: rgba(66, 185, 131, 0.1);
  border-radius: 4px;
}

blockquote code {
  background-color: transparent;
}

/* horizontal line */
hr {
  margin-top: 2rem;
  margin-bottom: 2rem;
  border-top: 2px dashed #abb2bf;
}

/* table */
table,
.md-table-fig .md-table {
  border: 1px solid #ddd;
  border-radius: 6px;
  border-collapse: separate;
  overflow: hidden;
}

table th,
table td,
.md-table-fig .md-table th,
.md-table-fig .md-table td {
  padding: 10px 16px;
  border-top: 1px solid #ddd;
  border-left: 1px solid #ddd;
}

table th:first-child,
table td:first-child,
.md-table-fig .md-table th:first-child,
.md-table-fig .md-table td:first-child {
  border-left: 0;
}

table thead,
.md-table-fig .md-table thead {
  background-color: #e7ecf3;
  color: #000;
}

table caption + thead tr:first-child th,
table caption + thead tr:first-child td,
table colgroup + thead tr:first-child th,
table colgroup + thead tr:first-child td,
table thead + tbody tr:first-child th,
table thead + tbody tr:first-child td,
table thead:first-child tr:first-child th,
table thead:first-child tr:first-child td,
.md-table-fig .md-table caption + thead tr:first-child th,
.md-table-fig .md-table caption + thead tr:first-child td,
.md-table-fig .md-table colgroup + thead tr:first-child th,
.md-table-fig .md-table colgroup + thead tr:first-child td,
.md-table-fig .md-table thead + tbody tr:first-child th,
.md-table-fig .md-table thead + tbody tr:first-child td,
.md-table-fig .md-table thead:first-child tr:first-child th,
.md-table-fig .md-table thead:first-child tr:first-child td {
  border-top: 0;
}

table tbody + tbody,
.md-table-fig .md-table tbody + tbody {
  border-top: 2px solid #ddd;
}

.md-table-fig .md-table-edit {
  background-color: #ddd;
}

.md-table-fig .md-table-edit .btn-default:hover {
  background-color: #bac6e9;
}

.md-table-fig .md-table-edit .md-table-resize-popover {
  -webkit-box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.16), 0 2px 10px 0 rgba(0, 0, 0, 0.12);
          box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.16), 0 2px 10px 0 rgba(0, 0, 0, 0.12);
  border: none;
  padding: 0;
  background-color: transparent;
}

.md-table-fig .md-table-edit .md-table-resize-popover .arrow {
  top: -10px;
}

.md-table-fig .md-table-edit .md-table-resize-popover .arrow::after {
  border-bottom-color: #ddd;
}

.md-table-fig .md-table-edit .md-table-resize-popover .md-reset {
  border-radius: 6px;
  background-color: #fff;
}

.md-table-fig .md-table-edit .md-table-resize-popover .md-reset input {
  color: #282c34 !important;
}

.md-table-fig .md-table-edit .md-table-resize-popover .md-reset input#md-grid-width, .md-table-fig .md-table-edit .md-table-resize-popover .md-reset input#md-grid-height {
  text-align: center;
}

.md-table-fig .md-table-edit .md-table-resize-popover .popover-title {
  border-top: 1px solid #eee;
}

/* yaml front matter */
#write pre.md-meta-block {
  background: #e7ecf3;
  color: #486491;
  border: 0;
  border-radius: 6px;
  line-height: 1.3rem;
  padding: 0.5rem 1.5rem;
  margin-top: -1rem;
  margin-bottom: 2rem;
}

/* table of contents */
.md-toc {
  margin-bottom: 1.25rem;
}

/* task list */
.md-task-list-item > input::before {
  content: "";
  position: absolute;
  top: -5px;
  left: -4px;
  border-radius: 50%;
  width: 20px;
  height: 20px;
  border: 1px solid #737373;
  background: #fff;
  -webkit-transition: background-color 200ms ease-in-out;
  transition: background-color 200ms ease-in-out;
}

.md-task-list-item > input::after {
  content: "";
  position: absolute;
  top: 2px;
  left: 1px;
  width: 0.6rem;
  height: 0.3rem;
  border: 2px solid #fff;
  border-top: 0;
  border-right: 0;
  -webkit-transform: rotate(-45deg);
          transform: rotate(-45deg);
  opacity: 0;
  -webkit-transition: opacity 200ms ease-in-out;
  transition: opacity 200ms ease-in-out;
}

.md-task-list-item > input:checked::before {
  background-color: #67c23a;
  border: none;
}

.md-task-list-item > input:checked::after {
  opacity: 1;
}

.md-task-list-item.task-list-done {
  text-decoration: line-through;
  color: #999;
}

/* footnote */
.footnotes {
  font-size: 1rem;
}

/* math,html block common */
.mathjax-block,
.md-htmlblock {
  -webkit-box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.16), 0 2px 10px 0 rgba(0, 0, 0, 0.12);
          box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.16), 0 2px 10px 0 rgba(0, 0, 0, 0.12);
  border-radius: 6px;
}

.mathjax-block[contenteditable="false"]:active, .mathjax-block[contenteditable="false"]:focus,
.md-htmlblock[contenteditable="false"]:active,
.md-htmlblock[contenteditable="false"]:focus {
  -webkit-box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.16), 0 2px 10px 0 rgba(0, 0, 0, 0.12);
          box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.16), 0 2px 10px 0 rgba(0, 0, 0, 0.12);
}

.mathjax-block:hover .md-rawblock-container,
.mathjax-block:hover .md-rawblock-tooltip,
.md-htmlblock:hover .md-rawblock-container,
.md-htmlblock:hover .md-rawblock-tooltip {
  background-color: #f5f6f7;
  -webkit-animation: showRawBlockTooltip 0s linear;
          animation: showRawBlockTooltip 0s linear;
}

.mathjax-block:hover .md-rawblock-container,
.md-htmlblock:hover .md-rawblock-container {
  border-radius: 6px 0 6px 6px;
}

.mathjax-block .md-rawblock-control,
.md-htmlblock .md-rawblock-control {
  background-color: #f5f6f7;
}

.mathjax-block .md-rawblock-tooltip,
.md-htmlblock .md-rawblock-tooltip {
  background-color: #f5f6f7;
  -webkit-animation: showRawBlockTooltip 0s linear;
          animation: showRawBlockTooltip 0s linear;
  border-radius: 4px 4px 0 0;
}

/* math block */
.mathjax-block .md-mathblock-panel .code-tooltip[contenteditable="false"] {
  -webkit-box-shadow: none;
          box-shadow: none;
}

.mathjax-block .md-mathblock-panel .md-rawblock-before {
  padding-top: 6px;
  border-top-left-radius: 6px;
}

.mathjax-block .md-mathblock-panel .md-rawblock-after {
  padding-bottom: 6px;
}

.mathjax-block .md-mathblock-panel .md-rawblock-input .cm-s-inner {
  color: #282c34;
}

.mathjax-block .md-mathblock-panel .md-rawblock-input .cm-s-inner .CodeMirror-lines {
  color: #282c34;
}

.mathjax-block .md-mathblock-panel .md-rawblock-input .cm-s-inner .CodeMirror-gutters {
  background-color: #f5f6f7;
}

.mathjax-block .md-mathblock-panel .md-rawblock-input .cm-s-inner .CodeMirror-selected,
.mathjax-block .md-mathblock-panel .md-rawblock-input .cm-s-inner .CodeMirror-selectedtext {
  background-color: #bac6e9 !important;
}

.mathjax-block .md-math-container {
  padding-top: 10px;
  padding-bottom: 10px;
}

/* html block */
.md-htmlblock .md-htmlblock-panel {
  border-radius: 6px;
  border-top-right-radius: 0;
  padding-left: 6px;
  padding-right: 6px;
}

.md-htmlblock .md-htmlblock-panel .md-rawblock-input {
  padding-top: 14px;
  padding-bottom: 10px;
}

.md-htmlblock .md-htmlblock-panel .md-rawblock-input .cm-s-inner .CodeMirror-selected,
.md-htmlblock .md-htmlblock-panel .md-rawblock-input .cm-s-inner .CodeMirror-selectedtext {
  background-color: #bac6e9 !important;
}

/* strong */
strong {
  background-color: inherit;
  color: #b5302e;
}

/* emphasis */
em {
  background-color: inherit;
  color: #949415;
}

/* underline */
u {
  background-color: inherit;
  color: inherit;
  text-decoration: none;
  border-bottom: 2px solid #f00;
  padding-bottom: 1px;
}

/* code */
h1 code,
h2 code,
h3 code,
h4 code,
h5 code,
h6 code {
  font-size: inherit;
}

code {
  background-color: rgba(34, 37, 38, 0.05);
  color: #e96900;
  font-family: "Fira Code", Consolas, "Lucida Console", "Courier", monospace, "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: 1rem;
  font-weight: 500;
  margin: 0 2px;
  padding: 3px 4px 1px;
  border-radius: 4px;
}

/* strike */
del {
  color: #999;
  text-decoration: line-through;
}

/* hightlight */
mark {
  color: #282c34;
  font-weight: 500;
  padding: 1px 5px 2px;
  border-radius: 2px;
}

/* hyperlink */
a {
  background-color: inherit;
  color: #2484c1;
  font-weight: 600;
  text-decoration: none;
}

a:hover {
  text-decoration: underline;
}

a img {
  border: none;
}

/* code fences */
.md-fences {
  font-family: "Fira Code", Consolas, "Lucida Console", "Courier", monospace, "Helvetica Neue", Helvetica, Arial, sans-serif;
  background-color: #282c34;
  padding-top: 6px;
  padding-bottom: 6px;
  padding-left: 10px;
  padding-right: 10px;
  -webkit-box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.16), 0 2px 10px 0 rgba(0, 0, 0, 0.12);
          box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.16), 0 2px 10px 0 rgba(0, 0, 0, 0.12);
  margin-bottom: 2.5rem;
  border: none;
  border-radius: 6px;
}

.md-fences[contenteditable="false"]:active, .md-fences[contenteditable="false"]:focus {
  -webkit-box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.16), 0 2px 10px 0 rgba(0, 0, 0, 0.12);
          box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.16), 0 2px 10px 0 rgba(0, 0, 0, 0.12);
}

.md-fences .code-tooltip {
  background-color: #282c34;
  border-radius: 4px;
}

.md-fences span {
  color: #abb2bf;
}

.md-fences .code-tooltip .ty-input {
  color: #fff;
  font-weight: 500;
}

.ty-show .autoComplt-list li.active {
  background-color: #bac6e9;
}

/* code container */
.cm-s-inner {
  background-color: #282c34;
}

.cm-s-inner .CodeMirror-gutters {
  background-color: #282c34;
  border: none;
}

.cm-s-inner .CodeMirror-guttermarker,
.cm-s-inner .CodeMirror-guttermarker-subtle,
.cm-s-inner .CodeMirror-linenumber {
  color: #737984;
}

.cm-s-inner .CodeMirror-cursor {
  border-left: 1px solid #528bff !important;
}

.cm-s-inner div.CodeMirror-selected {
  background: rgba(255, 255, 255, 0.15);
}

.cm-s-inner.CodeMirror-focused div.CodeMirror-selected {
  background: rgba(255, 255, 255, 0.1);
}

.cm-s-inner .CodeMirror-line::-moz-selection,
.cm-s-inner .CodeMirror-line > span::-moz-selection,
.cm-s-inner .CodeMirror-line > span > span::-moz-selection {
  background-color: #bac6e9;
}

.cm-s-inner .CodeMirror-line::selection,
.cm-s-inner .CodeMirror-line > span::selection,
.cm-s-inner .CodeMirror-line > span > span::selection {
  background-color: #bac6e9;
}

.cm-s-inner .CodeMirror-activeline-background {
  background: rgba(0, 0, 0, 0);
}

.cm-s-inner .CodeMirror-matchingbracket {
  text-decoration: underline;
  color: white !important;
}

.cm-s-inner .CodeMirror-selected,
.cm-s-inner .CodeMirror-selectedtext {
  background-color: #404859 !important;
}

/* code fences color */
.cm-s-inner .cm-keyword {
  color: #c678dd !important;
}

.cm-s-inner .cm-operator {
  color: #56b6c2 !important;
}

.cm-s-inner .cm-variable {
  color: #d19a66 !important;
}

.cm-s-inner .cm-variable-2 {
  color: #e06c75 !important;
}

.cm-s-inner .cm-variable-3 {
  color: #e06c75 !important;
}

.cm-s-inner .cm-builtin {
  color: #e8bf6a !important;
}

.cm-s-inner .cm-atom {
  color: #d19a66 !important;
}

.cm-s-inner .cm-number {
  color: #d19a66 !important;
}

.cm-s-inner .cm-def {
  color: #e06c75 !important;
}

.cm-s-inner .cm-string {
  color: #98c379 !important;
}

.cm-s-inner .cm-string-2 {
  color: #80cbc4 !important;
}

.cm-s-inner .cm-comment {
  color: #629755 !important;
}

.cm-s-inner .cm-tag {
  color: #e06c75 !important;
}

.cm-s-inner .cm-meta {
  color: #e06c75 !important;
}

.cm-s-inner .cm-attribute {
  color: #d19a66 !important;
}

.cm-s-inner .cm-property {
  color: #61afef !important;
}

.cm-s-inner .cm-qualifier {
  color: #decb6b !important;
}

.cm-s-inner .cm-error {
  color: #fff !important;
  background-color: #ec5f67 !important;
}

.cm-s-inner .cm-tag.cm-bracket {
  color: #abb2bf !important;
}

/* scrollbar */
::-webkit-scrollbar-thumb {
  background: rgba(0, 0, 0, 0.3) !important;
  border-radius: 4px;
}

/* find dialog */
#typora-quick-open {
  background-color: #fff;
  color: #282c34;
}

#typora-quick-open .typora-quick-open-item.active {
  background-color: #bac6e9 !important;
}

#typora-quick-open .ty-quick-open-category-title {
  border-top: 1px solid #eee !important;
}

/* modal dialog */
#common-dialog .modal-dialog .modal-content {
  -webkit-box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.16), 0 2px 10px 0 rgba(0, 0, 0, 0.12);
          box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.16), 0 2px 10px 0 rgba(0, 0, 0, 0.12);
  background-color: #f5f6f7;
  border: none;
  border-radius: 6px;
}

#common-dialog .modal-dialog .modal-content .modal-footer .btn-default:hover {
  background-color: #bac6e9 !important;
}

/* preferences */
.ty-preferences {
  font-family: "Fira Code", Consolas, "Lucida Console", "Courier", monospace, "Helvetica Neue", Helvetica, Arial, sans-serif;
  color: #282c34;
}

.ty-preferences .window-header h2 {
  font-size: 1.6rem;
}

.ty-preferences .sidebar {
  font-size: 1.4rem;
}

.ty-preferences .sidebar .nav-group-item.active,
.ty-preferences .sidebar .nav-group-item:active {
  color: #efefef;
  background-color: #2f845e;
}

/* sidebar includes file-tree,articles and outline*/
.html-for-mac #typora-sidebar {
  -webkit-box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.16), 0 2px 10px 0 rgba(0, 0, 0, 0.12);
          box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.16), 0 2px 10px 0 rgba(0, 0, 0, 0.12);
}

/* focus mode/typewriter mode notification  */
#md-notification {
  background-color: #fff !important;
}

#md-notification #ty-surpress-mode-warning-close-btn:hover {
  background-color: #bac6e9 !important;
}

/* Unibody sidebar */
#megamenu-menu-sidebar {
  color: #282c34;
  font-size: 1rem;
}

#megamenu-menu-sidebar #megamenu-menu-list {
  border-top-color: rgba(171, 192, 208, 0.1);
  background-color: #222526;
}

#megamenu-menu-sidebar #megamenu-menu-list li {
  font-size: 0.8rem;
}

#megamenu-menu-sidebar #megamenu-menu-list li a {
  color: #abc0d0 !important;
}

#megamenu-menu-sidebar #megamenu-menu-list li a.active, #megamenu-menu-sidebar #megamenu-menu-list li a:hover {
  background-color: #3e4249 !important;
}

#megamenu-menu-sidebar #megamenu-menu-list li a#m-saved {
  background-color: transparent !important;
}

.megamenu-opened .megamenu-menu {
  left: 0;
}

#megamenu-content {
  color: #000;
}

/* sidebar */
#typora-sidebar {
  background-color: #fafafa;
  border-right: 1px solid #eee;
}

#typora-sidebar #sidebar-loading-template.file-list-item {
  border-bottom: transparent !important;
  background-color: rgba(171, 192, 208, 0.1);
}

#typora-sidebar .info-panel-tab-wrapper .info-panel-tab:hover {
  color: inherit;
}

#typora-sidebar .info-panel-tab-wrapper .info-panel-tab .info-panel-tab-border {
  background-color: #2f845e;
  border-radius: 4px;
}

#typora-sidebar .sidebar-osx-tab .sidebar-tabs {
  border-bottom-color: transparent;
}

#typora-sidebar #sidebar-content .file-list-item {
  border-bottom: 1px solid #eee;
}

#typora-sidebar #sidebar-content .file-list-item.active {
  background-color: rgba(66, 185, 131, 0.1);
  border-left: 4px solid #2f845e;
}

#typora-sidebar #sidebar-content .ty-sidebar-search-panel {
  border-bottom: 1px solid #eee;
}

#typora-sidebar #sidebar-content .ty-sidebar-search-panel .searchpanel-search-option-btn {
  background-color: #fff;
}

#typora-sidebar #sidebar-content .sidebar-content-content .file-node-content {
  line-height: 1.375rem;
  font-size: 1rem;
  color: #282c34 !important;
}

#typora-sidebar #sidebar-content .sidebar-content-content .file-tree-node:not(.file-node-root):hover > .file-node-background {
  border-left: 4px solid #2f845e;
  background-color: rgba(66, 185, 131, 0.1);
}

#typora-sidebar #sidebar-content .sidebar-content-content .file-tree-node.active > .file-node-background {
  border-color: #2f845e;
  background-color: rgba(66, 185, 131, 0.1);
}

#typora-sidebar #sidebar-content .sidebar-content-content #file-library-list-children .file-library-file-node:hover {
  border-left: 4px solid #2f845e;
  background-color: rgba(66, 185, 131, 0.1);
}

#typora-sidebar #sidebar-content #outline-content .no-collapse-outline .outline-item {
  line-height: 1.375rem;
  font-size: 1rem;
}

#typora-sidebar #sidebar-content #outline-content .outline-expander:before {
  color: inherit;
  font-size: 14px;
  top: auto;
  content: "\f0da";
  font-family: FontAwesome;
}

#typora-sidebar #sidebar-content #outline-content .outline-expander:hover:before,
#typora-sidebar #sidebar-content #outline-content .outline-item-open > .outline-item > .outline-expander:before {
  content: "\f0d7";
}

#typora-sidebar #sidebar-content #outline-content .outline-item:hover {
  background-color: #bac6e9 !important;
}

#typora-sidebar #ty-sidebar-footer {
  border-top: 1px solid #eee;
}

#typora-sidebar #ty-sidebar-footer .sidebar-footer-item:hover {
  background-color: #bac6e9 !important;
}

#typora-sidebar #ty-sidebar-footer #sidebar-files-menu {
  -webkit-box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.16), 0 2px 10px 0 rgba(0, 0, 0, 0.12);
          box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.16), 0 2px 10px 0 rgba(0, 0, 0, 0.12);
}

/* dropdown menu */
.dropdown-menu {
  background-color: #fff;
  -webkit-box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.16), 0 2px 10px 0 rgba(0, 0, 0, 0.12);
          box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.16), 0 2px 10px 0 rgba(0, 0, 0, 0.12);
  border-top: 1px solid #eee;
}

.dropdown-menu > .show + .menuitem-group-label.show {
  border-top: 1px solid #eee !important;
}

.dropdown-menu > .active > a,
.dropdown-menu > li > a:hover,
.dropdown-menu .menu-style-btn.active {
  background-color: #bac6e9 !important;
}

.dropdown-menu li a {
  color: #282c34 !important;
}

.dropdown-menu li a:hover {
  background-color: #bac6e9 !important;
}

.dropdown-menu .divider {
  border-color: #fff;
}

/* sidebar-files-menu,toc-dropmenu,suggest common */
#sidebar-files-menu,
#toc-dropmenu,
.auto-suggest-container {
  background-color: #fff;
  -webkit-box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.16), 0 2px 10px 0 rgba(0, 0, 0, 0.12);
          box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.16), 0 2px 10px 0 rgba(0, 0, 0, 0.12);
  border: none;
}

#toc-dropmenu .outline-item:hover {
  background-color: #bac6e9 !important;
}

/* emoji,fences,word suggest */
.auto-suggest-container {
  padding-top: 4px;
  padding-bottom: 4px;
}

.auto-suggest-container li.active, .auto-suggest-container li:hover {
  background-color: #bac6e9 !important;
}

/** source code mode */
#typora-source {
  font-family: "Fira Code", Consolas, "Lucida Console", "Courier", monospace, "Helvetica Neue", Helvetica, Arial, sans-serif;
  color: #6a6a6a;
}

#typora-source .cm-s-typora-default .cm-header,
#typora-source .cm-s-typora-default .cm-property,
#typora-source .CodeMirror.cm-s-typora-default div.CodeMirror-cursor {
  color: #428bca;
}

#typora-source .cm-s-typora-default .cm-atom,
#typora-source .cm-s-typora-default .cm-number {
  color: #777777;
}

#typora-source .CodeMirror-selectedtext {
  background-color: transparent !important;
}

.typora-node .file-list-item-parent-loc,
.typora-node .file-list-item-time,
.typora-node .file-list-item-summary {
  font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", Helvetica, "PingFang SC", "Microsoft YaHei", sans-serif;
}



mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}
mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
							stroke-width: 0;
						} @media print { @page {margin: 0 0 0 0;} body.typora-export {padding-left: 0; padding-right: 0;} #write {padding:0;}}
</style><title>指令流水线</title>
</head>
<body class='typora-export'><div class='typora-export-content'>
<div id='write'  class=''><h1 id='指令流水线'><span>指令流水线</span></h1><p><span>2022.08.29</span></p><div class='md-toc' mdtype='toc'><p class="md-toc-content" role="list"><span role="listitem" class="md-toc-item md-toc-h1" data-ref="n260"><a class="md-toc-inner" style="" href="#指令流水线">指令流水线</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n265"><a class="md-toc-inner" style="" href="#指令流水线的基本概念">指令流水线的基本概念</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n269"><a class="md-toc-inner" style="" href="#指令流水的定义">指令流水的定义</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n297"><a class="md-toc-inner" style="" href="#流水线的表示方法">流水线的表示方法</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n302"><a class="md-toc-inner" style="" href="#流水线的基本实现">流水线的基本实现</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n305"><a class="md-toc-inner" style="" href="#流水线的数据通路">流水线的数据通路</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n318"><a class="md-toc-inner" style="" href="#流水线的控制信号">流水线的控制信号</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n319"><a class="md-toc-inner" style="" href="#流水线的执行过程">流水线的执行过程</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n320"><a class="md-toc-inner" style="" href="#流水线的冒险与处理">流水线的冒险与处理</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n447"><a class="md-toc-inner" style="" href="#结构冒险">结构冒险</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n459"><a class="md-toc-inner" style="" href="#数据冒险">数据冒险</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n497"><a class="md-toc-inner" style="" href="#控制冒险">控制冒险</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n321"><a class="md-toc-inner" style="" href="#流水线的性能指标">流水线的性能指标</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n322"><a class="md-toc-inner" style="" href="#高级流水线技术">高级流水线技术</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n541"><a class="md-toc-inner" style="" href="#超标量流水线技术">超标量流水线技术</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n551"><a class="md-toc-inner" style="" href="#超长指令字技术">超长指令字技术</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n559"><a class="md-toc-inner" style="" href="#超流水线技术">超流水线技术</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n323"><a class="md-toc-inner" style="" href="#例题">例题</a></span></p></div><p><span>前面介绍的指令都是在单周期处理机中采用串行方法执行的，同一时刻 CPU 中只有一条指令在执行，因此各功能部件的使用率不高。现代计算机普遍采用指令流水线技术，同一时刻有多条指令在 CPU 的不同功能部件中并发执行，大大提高了功能部件的并行性和程序的执行效率。</span></p><h2 id='指令流水线的基本概念'><span>指令流水线的基本概念</span></h2><p><span>可从两方面提高处理机的并行性</span></p><p><span>①</span><strong><span>时间上的并行技术</span></strong><span>，将一个任务分解为几个不同的子阶段，每个阶段在不同的功能部件上并行执行，以便在同一时刻能够同时执行多个任务，进而提升系统性能，这种方法被称为</span><strong><span>流水线技术</span></strong><span>。</span></p><p><span>②</span><strong><span>空间上的井行技术</span></strong><span>，在一个处理机内设置多个执行相同任务的功能部件，并让这些功能部件并行工作，这样的处理机被称为</span><strong><span>超标量处理机</span></strong><span>。</span></p><h3 id='指令流水的定义'><span>指令流水的定义</span></h3><p><u><span>一条指令的执行过程可分解为若干阶段，每个阶段由相应的功能部件完成。如果将各阶段视为相应的流水段，则指令的执行过程就构成了一条指令流水线</span></u><span>。</span></p><p><span>假设一条指令的执行过程分为如下 5个阶段（也称功能段或流水段）：</span></p><ol start='' ><li><span>取指（IF)：从指令存储器或 Cache 中取指令</span></li><li><span>译码/读寄存器(ID)：操作控制器对指令进行译码，同时从寄存器堆中取操作数</span></li><li><span>执行/计算地址（EX）：执行运算操作或计算地址。</span></li><li><span>访存(MEM)：对存储器进行读写操作。</span></li><li><span>写回 (WB)：将指令执行结果写回寄存器堆。</span></li></ol><p><span>把k＋1条指令的取指阶段提前到第k条指令的译码阶段，从而将第k+1条指令的译码阶段与第k条指令的执行阶段同时进行，如图所示。</span></p><p><img src="resources/指令流水线举例.png" referrerpolicy="no-referrer" alt="截屏2022-08-28 下午9.44.52"></p><p><span>理想情况下，每个时钟周期都有一条指令进入流水线，每个时钟周期都有一条指令完成，每条指令的时钟周期数（即CPI）都为 1。</span></p><p><span>流水线设计的原则是，指令流水段个数以最复杂指令所用的功能段个数为准：流水段的长度以最复杂的操作所花的时间为准。假设某条指令的 5 个阶段所花的时间分别如下。①取指：200ps： ② 译码：100ps： ③ 执行：150ps; ④访存：200ps: ⑤写回：100ps，该指令的总执行时间为 750ps。按照流水线设计原则，每个流水段的长度为 200ps，所以每条指令的执行时间为1ns， 反而比串行执行时增加了 250ps。 假设某程序中有 N 条指令，单周期处理机所用的时间为Nx750ns， 而流水线处理机所用的时间为(N ＋ 4)x200ns。由此可见，流水线方式并不能缩短单条指令的执行时间，但对于整个程序来说，执行效率得到了大幅增高。</span></p><p><span>为了利于实现指令流水线，</span><u><span>指令集应具有如下特征</span></u><span>：</span></p><ol start='' ><li><strong><span>指令长度应尽量一致</span></strong><span>，有利于简化取指令和指令译码操作。否则，取指令所花时间长短不一，使取指部件极其复杂，且也不利于指令译码。</span></li><li><strong><span>指令格式应尽量规整</span></strong><span>，尽量保证源寄存器的位置相同，有利于在指令未知时就可取寄存器操作数，否则须译码后才能确定指令中各寄存器编号的位置。</span></li><li><span>采用 </span><strong><span>Load/Store</span></strong><span> 指令，其他指令都不能访问存储器，这样可把 Load/Store 指令的地址计算和运算指令的执行步骤规整在同一个周期中，有利于减少操作步骤。</span></li><li><span>数据和指令在存储器中</span><strong><span>“对齐”</span></strong><span>存放。这样，有利于减少访存次数，使所需数据在一个流水段内就能从存储器中得到.</span></li></ol><h3 id='流水线的表示方法'><span>流水线的表示方法</span></h3><p><span>通常用</span><strong><span>时空图</span></strong><span>来直观地描述流水线的执行情况。</span></p><p><span>在时空图中，横坐标表示时间，它被分割成长度相等的时间段T; 纵坐标为空间，表示当前指令所处的功能部件。在下图中，第一条指令I1 在时刻 0进入流水线，在时刻 5T 流出流水线。第二条指令 I2，在时刻下进入流水线，在时刻6T 流出流水线。以此类推，每隔一个时间T就有一条指令进入流水线，从时刻5T开始每隔一个时间下就有一条指令流出流水线。</span></p><p><img src="resources/时空图.png" referrerpolicy="no-referrer" alt="截屏2022-08-28 下午10.02.12"></p><p><span>从图中可看出，在时刻 10T 时，流水线上便有 6条指令流出。若采用串行方式执行，在时刻 10T时，只能执行2条指令，可见使用流水线方式成倍地提高了计算机的速度。只有大量连续任务不断输入流水线，才能充分发挥流水线的性能，而指令的执行正好是连续不断的，非常适合采用流水线技术。对于其他部件级流水线，如浮点运算流水线，同样也仅适合于提升浮点运算密集型应用的性能，对于单个运算是无法提升性能的。</span></p><h2 id='流水线的基本实现'><span>流水线的基本实现</span></h2><p><span>在单周期实现中，这5个功能段是串连在一起的，如图所示。将程序计数器 (PC)的值送入IF 段取指令，然后依次进入 ID、EX、MEM、WB 段。虽然不是所有指令都必须经历完整的 5 个阶段，但只能以执行速度最慢的指令作为设计其时钟周期的依据，单周期 CPU 的时钟频率取决于数据通路中的关键路径 (最长路径），因此单周期 CPU 指令执行效率不佳。</span></p><p><img src="resources/单周期处理机逻辑架构.png" referrerpolicy="no-referrer" alt="截屏2022-08-29 上午9.05.09"></p><h3 id='流水线的数据通路'><span>流水线的数据通路</span></h3><blockquote><p><span>Overview:</span></p><p><span>流水寄存器中的数据传递情况</span></p></blockquote><p><span>一个5段流水线数据通路如下图所示。其中：</span></p><ol start='' ><li><span>IF 段包括程序计数器 (PC)、指令存储器、下条指令地址的计算逻辑</span></li><li><span>ID 段包括操作控制器、取操作数逻辑、立即数符号扩展模块</span></li><li><span>EX 段主要包括算术逻辑单元 （ALU）、分支地址计算模块</span></li><li><span>MEM 段主要包括数据存储器读写模块</span></li><li><span>WB 段主要包括寄存器写入控制模块。</span></li></ol><p><span>每个流水段后面都需要增加一个流水寄存器，用于锁存本段处理完成的数据和控制信号，以保证本段的执行结果能在下个时钟周期给下一流水段使用，图中增加了 4 个流水寄存器，并根据其所连接的功能段来命名。各种寄存器和数据存储器均采用统一时钟 CLK 进行同步，每来一个时钟，就会有一条新的指令进入流水线 IF 段：同时流水寄存器会锁存前段加工处理完成的数据和控制信号，为下一段的功能部件提供数据输入。</span></p><p><img src="resources/5段流水线数据通路.png" referrerpolicy="no-referrer" alt="image-20220829091345660"></p><p><span>不同流水寄存器锁存的数据不相同，如上图中的实线表示。IF/ID 流水寄存器需要锁存从指令存储器取出的指令字，以及PC+4的值：ID/EX 流水寄存器需要锁存从寄存器堆中取出的两个操作数 RS 和 RT（指令中两个操作数字段对应的寄存器值） 与写寄存器编号 VritcReg， 以及立即数符号扩展的值、PC ＋4等后段可能用到的操作数：EX/MEM 流水寄存器需要锁存 ALU 运算结果、数据存储器待写入数据 WriteData、写寄存器编号 WriteRcg#等数据：MEM/WB 流水寄存器话要锁存 ALU 运算结果、数据存储器读出数据、写寄存器编号 WritcReg#等数据。</span></p><h3 id='流水线的控制信号'><span>流水线的控制信号</span></h3><p><span>上节描述了数据通过流水寄存器进行传递的情况。但是在某一时刻，每个流水段执行不同指令的某个阶段，每个流水段还需要</span><u><span>正在执行指令的对应功能段的控制信号</span></u><span>。</span></p><p><span>上图中的控制信号（虚线表示）如下表所示。</span><u><span>控制信号的来源并不一致</span></u><span>，如IF段的分支转跳信号 BranchTaken 来源于 EX 段，ID段的 RegWrite 信号来源于 WB 段。其他控制信号通过控制器产生，由ID段负责译码生成控制信号，并分别在随后的各个时钟周期内使用。</span></p><figure><table><thead><tr><th style='text-align:center;' ><span>控制信号</span></th><th style='text-align:center;' ><span>位置</span></th><th style='text-align:center;' ><span>来源</span></th><th style='text-align:center;' ><span>功能说明</span></th></tr></thead><tbody><tr><td style='text-align:center;' ><span>BranchTaken</span></td><td style='text-align:center;' ><span>IF</span></td><td style='text-align:center;' ><span>EX</span></td><td style='text-align:center;' ><span>分支跳转信号，为1表示跳转，由EX段的Branch信号与equal标志进行逻辑与生成</span></td></tr><tr><td style='text-align:center;' ><span>RegDst</span></td><td style='text-align:center;' ><span>ID</span></td><td style='text-align:center;' ><span>ID</span></td><td style='text-align:center;' ><span>写入目的寄存器选择，为1时目的寄存器为rd寄存器，为0时为rt寄存器</span></td></tr><tr><td style='text-align:center;' ><span>RegWrite</span></td><td style='text-align:center;' ><span>ID</span></td><td style='text-align:center;' ><span>WB</span></td><td style='text-align:center;' ><span>控制寄存器推写操作，为1时数据需要写回寄存器堆中的指定寄存器</span></td></tr><tr><td style='text-align:center;' ><span>AluSre</span></td><td style='text-align:center;' ><span>EX</span></td><td style='text-align:center;' ><span>EX</span></td><td style='text-align:center;' ><span>ALU的第二个输入选择控制，为0时输入寄存器rt，为1时输入扩展后的立即数</span></td></tr><tr><td style='text-align:center;' ><span>AluOp</span></td><td style='text-align:center;' ><span>EX</span></td><td style='text-align:center;' ><span>EX</span></td><td style='text-align:center;' ><span>控制ALU进行不同运算，具体取值和位宽与ALU的设计有关</span></td></tr><tr><td style='text-align:center;' ><span>MemWrite</span></td><td style='text-align:center;' ><span>MEM</span></td><td style='text-align:center;' ><span>MEM</span></td><td style='text-align:center;' ><span>控制数据存储器写操作，为0时进行读操作，为1时进行写操作</span></td></tr><tr><td style='text-align:center;' ><span>MemToReg</span></td><td style='text-align:center;' ><span>WB</span></td><td style='text-align:center;' ><span>WB</span></td><td style='text-align:center;' ><span>为1时将数据存储器读出数据写回寄存器堆，否则将ALU运算结果写回</span></td></tr></tbody></table></figure><p><span>控制器的输入主要是 IF/ID 流水寄存器锁存的指令字中的 OP 字段，输出为 7个控制信号其中 RegDst 信号在 ID 段使用，其他6个后段使用的控制信号输出到 ID/EX 流水寄存器中并依次向后传递，以供后续各流水段使用。RegWrite 信号必须传递至 WB 段后才能反馈到 ID 段的寄存器堆的写入控制段 WE；条件分支译码信号 Branch 也需要传递到EX 段，与 ALU 运算的标志 equal 信号进行逻我与操作后，反馈到ID段控制多路选择器进行分支处理。</span></p><p><span>综上所述，每个流水奇存器中保存的信息包括：①后面流水段需要用到的所有数据信息包括 PC ＋4、指令、立即数、目的寄存器、ALU 运算结果、标志信息等，它们是前面阶段在数据通路中执行的结果：②前面传递过来的后面各流水段要用到的所有控制信号。</span></p><h3 id='流水线的执行过程'><span>流水线的执行过程</span></h3><p><span>由于流水线的特殊结构，所有指令都需要完整经过流水线的各功能段，只不过某些指令在某些功能段内没有任何实质性的操作，只是等待一个时钟周期，这也就意味着单条指令的执行时间还是 5个功能段时间延迟的总和。</span></p><p><img src="resources/5段流水线数据通路.png" referrerpolicy="no-referrer" alt="image-20220829091345660"></p><ol><li><p><span>取指（IF）</span></p><p><span>将PC值作为地址从指令寄存器中取出第一条指令字：并计算PC +4， 送入PC 输入端，以便在下一个时钟周期取下条指令，这些功能由取指部件完成。取出的指令字通过 RD 输出端送入 I/D 流水寄存器，PC＋4也要送入IF/ID 流水寄存器，以备后续可能使用（如相对转移指令）。只要是后续功能段有可能要用到的数据和控制信号，都要向后传递。时钟到来时将更新后的 PC值和指令字锁存到IF/ID 流水奇存器中：本条指令I1进入ID段，IF段取出下条指令I2。</span></p></li><li><p><span>译码/读寄存器(ID)</span></p><p><span>由控制器根据 IF/ID 流水寄存器中的指令字生成后续各段需要的控制信号。对于 Iw 访存指令，根据指令字中的rs、rt取出寄存器堆中的值 RS 和RT；符号扩展单元会将指令字中的 16位立即数符号扩展为 32 位；多路选择器根据指令字生成指令可能的写寄存器编号 WiteReg#。时钟到来时，这些数据和控制信号，连同顺序指令地址 PC ＋4，都会锁存到 ID/EX 流水寄存器中：指令I1进入EX 段，同时下条指令I2进入ID段，下下条指令I3进入IF段。</span></p></li><li><p><span>执行/计算地址 (EX)</span></p><p><span>EX 段功能由具体指令确定，不同指令经 ID 段译码后得到不同的控制信号。对于 Iw 指令，EX 主要用来计算访存地址，将ID/EX 流水奇存器中的 RS 值与符号扩展后的立即数相加得到的访存地址送入 EX/MEM 流水奇存器。Ex 段可能还要计算分支地址，生成分支转跳信号 Branch Taken。 RT 的值可能会在 MEM 段作为写入数据使用，所以 RT 会作为写入数据 Write Data 送入 EXMEM 流水寄存器；ID/EX 流水寄存器中的写寄存器编号 WriteReg#也将直接传送给 EX/MEM 流水寄存器。时钟到来后，这些数据和后段需要的控制信号都会锁存到 EX/MEM 流水寄存器中：指令I1进入 MEM 段，后续指令I2、I3、I4分别进入区X、DD、IF段。</span></p></li><li><p><span>访存 (MEM)</span></p><p><span>MEM 段的功能也由具体指令确定。对于Iw指令，主要是根据 EX/MEM 流水寄存器中锁存的访存地址，写入数据和内存读写控制信号 Mem Write 对存储器进行读或写操作。EX/MEM 流水寄存器中的访存地址、WriteReg#、数据存储器读出的数据都会送入 MEM/WB 流水奇存器，以备后续可能使用。时钟到来后，这些数据和后段需要的控制信号都会锁存到 MEM/WB 流水寄存器中；指令I1进入WB段，后续指令分别进入MEM、EX、DD、IF段。</span></p></li></ol><ol start='5' ><li><p><span>写回(WB)</span></p><p><span>WB 段的功能也由具体指令确定。将MEM/WB 流水奇存器中数据存储器读出的数据写回指定寄存器 WriteReg#。时钟到来时会完成数据写入寄存器，指令I1，离开流水线。此时，指令I2进入最后的WB段，后续指令分别进入 MEM、EX、ID段，指令I6进入正段。</span></p></li></ol><h2 id='流水线的冒险与处理'><span>流水线的冒险与处理</span></h2><p><span>在指令流水线中，可能会遇到一些情况使得流水线无法正确执行后续指令而引起流水线阻塞或停顿，这种现象称为流水线冒险。根据导致冒险的原因不同主要有 3种：结构冒险（资源冲突）、数据冒险（数据冲突）和控制冒险（控制冲突）。</span></p><h3 id='结构冒险'><span>结构冒险</span></h3><p><span>由于多条指令在同一时刻争用同一资源而形成的冲突，也称为</span><strong><span>资源冲突</span></strong><span>，即由硬件资源竞争造成的冲突，有以下两种解决办法：</span></p><ol><li><span>前一指令访存时，使后一条相关指令（以及其后续指令）</span><strong><span>暂停一个时钟周期</span></strong><span>。</span></li><li><strong><span>单独设置数据存储器和指令存储器</span></strong><span>，使取数和取指令操作各自在不同的存储器中进行。事实上，现代计算机都引入了 Cache 机制，而 L1 Cache 通常采用数据 Cache 和指令Cache 分离的方式，因而也就避免了资源冲突的发生。</span></li></ol><h3 id='数据冒险'><span>数据冒险</span></h3><p><span>在一个程序中，</span><u><span>下一条指令会用到当前指令计算出的结果</span></u><span>，此时这两条指令发生数据冲突。当多系指令重叠处理时就会发生冲突，数据冒险可分为三类（结合综合题了理解）：</span></p><ol><li><strong><span>写后读</span></strong><span> (Read Affer Write, RAW） 相关：表示当前指令将数据写入寄存器后，下一条指令才能从该寄存器读取数据。否则，先读后写，读到的就是错误（旧）数据。</span></li><li><strong><span>读后写</span></strong><span>(Write Afer Read, WAR)相关：表示当前指令读出数据后，下一条指令才能写该寄存器。否则，先写后读，读到的就是错误（新）数据。</span></li><li><strong><span>写后写</span></strong><span>(Write Afier Write, WAW）相关：表示当前指令写入奇存器后，下一条指令才能写该寄存器。否则，下一条指令在当前指令之前写，将使寄存器的值不是最新值。</span></li></ol><p><span>解决的办法有以下几种：</span></p><ol><li><span>把遇到数据相关的指令及其后线指令都</span><strong><span>暂停</span></strong><span>一至几个时钟周期，直到数据相关问题消失后再继续执行，可分为</span><strong><span>硬件阻塞（stall）</span></strong><span>和</span><strong><span>软件插入 “NOP” 指令</span></strong><span>两种方法，</span></li><li><span>设置</span><strong><span>相关专用通路</span></strong><span>，即不等前一条指令把计算结果写回寄存器组，下一条指令也不再读寄存器组，而直接把前一条指令的 ALU 的计算结果作为自己的输入数据开始计算过程，使本来需要暂停的操作变得可以继续执行，这称为数据旁路技术。</span></li><li><span>通过编译器对数据相关的指令</span><strong><span>编译优化</span></strong><span>的方法，调整指令顺序来解决数据相关。</span></li></ol><h3 id='控制冒险'><span>控制冒险</span></h3><p><span>指令通常是顺序执行的，但足在遇到改变指令执行顺序的情况，例如执行转移、调用或返回等指令时，会</span><strong><span>改变PC值，会造成断流</span></strong><span>，从而引起控制冒险。解决的办法有以下几种：</span></p><ol><li><span>对转移指令进行</span><strong><span>分支预测</span></strong><span>，尽早生成转移目标地址。分支预测分为简单（静态）预测和动态预测。静态预测总是预测条件不满足，即继续执行分支指令的后续指令。动态预测根据程序执行的历史情况，进行动态预测调整，有较高的预测准确率。</span></li><li><span>预取转移成功和不成功两个控制流方向上的目标指令。</span></li><li><span>加快和提前形成条件码。</span></li><li><span>提高转移方向的猜准率。</span></li></ol><p><span>注意：Cache 缺失的处理过程也会引超流水线阻塞。在不过多增加硬件成本的情況下，如何尽可能地提高指令流水线的运行效率是选用指令流水线技术必须解决的关键问题。</span></p><h2 id='流水线的性能指标'><span>流水线的性能指标</span></h2><ol><li><p><span>流水线的吞吐率</span></p><p><span>流水线的吞吐率是指在单位时间内流水线所完成的任务数量，或输出结果的数量。流水线吞吐率（TP）的最基本公式为</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n527" cid="n527" mdtype="math_block" data-math-tag-before="0" data-math-tag-after="0" data-math-labels="[]"><div class="md-rawblock-container md-math-container" tabindex="-1"><mjx-container class="MathJax" jax="SVG" display="true" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="9.647ex" height="4.438ex" role="img" focusable="false" viewBox="0 -1118 4264 1961.8" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -1.909ex;"><defs><path id="MJX-205-TEX-I-1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path><path id="MJX-205-TEX-I-1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path><path id="MJX-205-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-205-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-205-TEX-I-1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D447" xlink:href="#MJX-205-TEX-I-1D447"></use></g><g data-mml-node="mi" transform="translate(704,0)"><use data-c="1D443" xlink:href="#MJX-205-TEX-I-1D443"></use></g><g data-mml-node="mo" transform="translate(1732.8,0)"><use data-c="3D" xlink:href="#MJX-205-TEX-N-3D"></use></g><g data-mml-node="mfrac" transform="translate(2788.6,0)"><g data-mml-node="mi" transform="translate(437.7,676)"><use data-c="1D45B" xlink:href="#MJX-205-TEX-I-1D45B"></use></g><g data-mml-node="msub" transform="translate(220,-686)"><g data-mml-node="mi"><use data-c="1D447" xlink:href="#MJX-205-TEX-I-1D447"></use></g><g data-mml-node="mi" transform="translate(617,-150) scale(0.707)"><use data-c="1D458" xlink:href="#MJX-205-TEX-I-1D458"></use></g></g><rect width="1235.4" height="60" x="120" y="220"></rect></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>T</mi><mi>P</mi><mo>=</mo><mfrac><mi>n</mi><msub><mi>T</mi><mi>k</mi></msub></mfrac></math></mjx-assistive-mml></mjx-container></div></div><p><span>式中，n 是任务数，Tk 是处理完 n 个任务所用的总时间。设 k 为流水段的段数，</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="2.701ex" height="1.645ex" role="img" focusable="false" viewBox="0 -716 1194 727" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.025ex;"><defs><path id="MJX-204-TEX-N-394" d="M51 0Q46 4 46 7Q46 9 215 357T388 709Q391 716 416 716Q439 716 444 709Q447 705 616 357T786 7Q786 4 781 0H51ZM507 344L384 596L137 92L383 91H630Q630 93 507 344Z"></path><path id="MJX-204-TEX-I-1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="394" xlink:href="#MJX-204-TEX-N-394"></use></g><g data-mml-node="mi" transform="translate(833,0)"><use data-c="1D461" xlink:href="#MJX-204-TEX-I-1D461"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Δ</mi><mi>t</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">\Delta t</script><span>为时钟周期。在输入流水线中的任务连续的理想情况下，一条k段流水线能在k+n-1个时钟周期内完成n个任务。得出流水线的吞吐率为</span></p><div contenteditable="false" spellcheck="false" class="mathjax-block md-end-block md-math-block md-rawblock" id="mathjax-n535" cid="n535" mdtype="math_block" data-math-tag-before="0" data-math-tag-after="0" data-math-labels="[]"><div class="md-rawblock-container md-math-container" tabindex="-1"><mjx-container class="MathJax" jax="SVG" display="true" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="20.965ex" height="4.701ex" role="img" focusable="false" viewBox="0 -1118 9266.4 2078" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -2.172ex;"><defs><path id="MJX-206-TEX-I-1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path><path id="MJX-206-TEX-I-1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path><path id="MJX-206-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-206-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-206-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-206-TEX-I-1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path><path id="MJX-206-TEX-N-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path><path id="MJX-206-TEX-N-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path id="MJX-206-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-206-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path id="MJX-206-TEX-N-394" d="M51 0Q46 4 46 7Q46 9 215 357T388 709Q391 716 416 716Q439 716 444 709Q447 705 616 357T786 7Q786 4 781 0H51ZM507 344L384 596L137 92L383 91H630Q630 93 507 344Z"></path><path id="MJX-206-TEX-I-1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D447" xlink:href="#MJX-206-TEX-I-1D447"></use></g><g data-mml-node="mi" transform="translate(704,0)"><use data-c="1D443" xlink:href="#MJX-206-TEX-I-1D443"></use></g><g data-mml-node="mo" transform="translate(1732.8,0)"><use data-c="3D" xlink:href="#MJX-206-TEX-N-3D"></use></g><g data-mml-node="mfrac" transform="translate(2788.6,0)"><g data-mml-node="mi" transform="translate(2938.9,676)"><use data-c="1D45B" xlink:href="#MJX-206-TEX-I-1D45B"></use></g><g data-mml-node="mrow" transform="translate(220,-710)"><g data-mml-node="mo"><use data-c="28" xlink:href="#MJX-206-TEX-N-28"></use></g><g data-mml-node="mi" transform="translate(389,0)"><use data-c="1D458" xlink:href="#MJX-206-TEX-I-1D458"></use></g><g data-mml-node="mo" transform="translate(1132.2,0)"><use data-c="2B" xlink:href="#MJX-206-TEX-N-2B"></use></g><g data-mml-node="mi" transform="translate(2132.4,0)"><use data-c="1D45B" xlink:href="#MJX-206-TEX-I-1D45B"></use></g><g data-mml-node="mo" transform="translate(2954.7,0)"><use data-c="2212" xlink:href="#MJX-206-TEX-N-2212"></use></g><g data-mml-node="mn" transform="translate(3954.9,0)"><use data-c="31" xlink:href="#MJX-206-TEX-N-31"></use></g><g data-mml-node="mo" transform="translate(4454.9,0)"><use data-c="29" xlink:href="#MJX-206-TEX-N-29"></use></g><g data-mml-node="mi" transform="translate(4843.9,0)"><use data-c="394" xlink:href="#MJX-206-TEX-N-394"></use></g><g data-mml-node="mi" transform="translate(5676.9,0)"><use data-c="1D461" xlink:href="#MJX-206-TEX-I-1D461"></use></g></g><rect width="6237.9" height="60" x="120" y="220"></rect></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>T</mi><mi>P</mi><mo>=</mo><mfrac><mi>n</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>+</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mi mathvariant="normal">Δ</mi><mi>t</mi></mrow></mfrac></math></mjx-assistive-mml></mjx-container></div></div><p><span>当n趋近于无穷时，</span><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="8.936ex" height="1.952ex" role="img" focusable="false" viewBox="0 -705 3949.9 862.8" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.357ex;"><defs><path id="MJX-216-TEX-I-1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path><path id="MJX-216-TEX-I-1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-216-TEX-I-1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path><path id="MJX-216-TEX-I-1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path><path id="MJX-216-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-216-TEX-I-1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D446" xlink:href="#MJX-216-TEX-I-1D446"></use></g><g data-mml-node="TeXAtom" transform="translate(646,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D45A" xlink:href="#MJX-216-TEX-I-1D45A"></use></g><g data-mml-node="mi" transform="translate(878,0)"><use data-c="1D44E" xlink:href="#MJX-216-TEX-I-1D44E"></use></g><g data-mml-node="mi" transform="translate(1407,0)"><use data-c="1D465" xlink:href="#MJX-216-TEX-I-1D465"></use></g></g></g><g data-mml-node="mo" transform="translate(2373.1,0)"><use data-c="3D" xlink:href="#MJX-216-TEX-N-3D"></use></g><g data-mml-node="mi" transform="translate(3428.9,0)"><use data-c="1D458" xlink:href="#MJX-216-TEX-I-1D458"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mrow data-mjx-texclass="ORD"><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo>=</mo><mi>k</mi></math></mjx-assistive-mml></mjx-container><script type="math/tex">S_{max}=k</script></p></li></ol><h2 id='高级流水线技术'><span>高级流水线技术</span></h2><p><span>有两种增加指令级并行的策略：一种是</span><strong><span>多发射技术</span></strong><span>，它通过采用多个内部功能部件，使流水线功能段能同时处理多条指令，处理机一次可以发射多条指令进入流水线执行：另一种是</span><strong><span>超流水线技术</span></strong><span>，它通过增加流水线级数来使更多的指令同时在流水线中重登执行。</span></p><h3 id='超标量流水线技术'><span>超标量流水线技术</span></h3><p><span>超标最流水线技术也称动态多发射技术，每个时钟周期内可并发多条独立指令，以并行操作方式将两条或多条指令编译并执行，为此需配置多个功能部件。超标量技术不能调监指令的执行顺序，此通过编译优化技术，把可并行执行的指令搭配起来，挖掘更多的指令并行性。</span></p><p><img src="resources/超标量.png" referrerpolicy="no-referrer" alt="image-20220829195815868"></p><h3 id='超长指令字技术'><span>超长指令字技术</span></h3><p><span>超长指令字技术也称静态多发射技术，由编译程序挖掘出指令间潜在的并行性，将多条能并行操作的指令组合成一条具有多个操作码字段的超长指令字（可达几百位），为此需要采用多个处理部件。</span></p><h3 id='超流水线技术'><span>超流水线技术</span></h3><p><span>如图所示，流水线功能段划分得越多，时钟周期就越短，指令吞吐率也就越高，因此超流水线技术是通过提高流水线主频的方式来提升流水线性能的。但是，流水线级数越多，用于流水寄存器的开销就越大，因而流水线级数是有限制的，并不是越多越好</span></p><p><img src="resources/超流水.png" referrerpolicy="no-referrer" alt="截屏2022-08-29 下午8.12.51"></p><h2 id='例题'><span>例题</span></h2><ol><li><p><span>下列关于流水 CPU 基本概念的描述中，正确的是 （ ）。</span>
<span>A. 流水CPU 是以空问并行性为原理构造的处理器</span>
<span>B. 流水CPU一定是RISC 机器</span>
<span>C. 流水CPU一定是多媒体 CPU</span>
<span>D. 流水CPU 是一种非常经济而实用的时问并行技术</span></p><p><span>【答案】：D</span></p></li></ol><ol start='02' ><li><p><span>下列关子超标量流水线的描述中，不正确的是（）。</span>
<span>A. 在一个时钟周期内一条流水线可执行一条以上的指令</span>
<span>B. 一条指令分为多段指令由不同电路单元完成</span>
<span>C. 超标量通过内置多条流水线来同时执行多个处理器，共实质是以空问换取时问</span>
<span>D. 超标量流水线是指运算操作并行</span></p><p><span>【答案】：B-&gt;D</span></p></li><li><p><span>下列关于动态流水线的描述中，正确的是(）。</span>
<span>A. 动态流水线是指在同一时问内，当某些段正在实现某种运算时，另一些段却正在进行另一种运算，这样对提高流水线的效率很有好处，但会使流水线控制变得很复杂</span>
<span>B. 动态流水线是指运算操作并行</span>
<span>C. 动态流水线是指指令步骤并行</span>
<span>D. 动态流水线是指程序步骤并行</span></p><p><span>【答案】：？-&gt;A。</span><strong><span>动态流水线</span></strong><span>是相对于静态流水线而言的，静态流水线上下段连接方式固定，而动态流水线的连接方式是可变的。</span></p></li><li><p><span>流水 CPU 是由一系列称为“段”的处理线路组成的。一个m段流水线稳定时的 CPU 的吞吐能力，与m 个并行部件的CPU 的吞吐能力相比,( )。</span>
<span>A. 具有同等水平的吞吐能力</span>
<span>B. 不具各同等水平的吞吐能力</span>
<span>C. 吞吐能力大于前者的吞吐能力</span>
<span>D. 吞吐能力小于前者的吞吐能力</span></p><p><span>【答案】：D-&gt;A</span></p></li><li><p><span>设指令由取指、分析、执行3个子部件完成，并且每个子部件的时问均为Delta t，若来用常规标号单流水线处理机（即处理机的度为 1），连续执行 12 条指令，共需（）。</span>
<span>A. 12Delta t</span>
<span>B. 14Delta t</span>
<span>C. 16Delta t</span>
<span>D. 18Delta t</span></p><p><span>【答案】：12+3-1=14, B</span></p></li><li><p><span>若来用度为4的超标量流水线处理机，连续执行上述20 条指令，只需（).</span>
<span>A. 3Delta t</span>
<span>B. 5Delta t</span>
<span>C. 7Delta t</span>
<span>D. 9Delta t</span></p><p><span>【答案】：5+3-1=7，C</span></p></li><li><p><span>设指令流水线把一条指令分为取指、分析、执行3 部分，且了部分的时间分别是t取指=2ns， t分析=2ns,t执行=1ns，則 100 条指令全部执行完毕需（）</span>
<span>A. 163ns</span>
<span>B. 183ns</span>
<span>C. 193ns</span>
<span>D. 203ns</span></p><p><span>【答案】：2x(100+3-1)=204，D</span></p></li><li><p><span>设指令由取指、分析、执行 3个子部件完成，并且每个子部件的时间均为，若采用常规标量单流水线处理机，连续执行8 条指令，則该流水线的加速比为（ ).</span>
<span>A. 3</span>
<span>B. 2</span>
<span>C. 3.4</span>
<span>D. 2.4</span></p><p><span>【答案】：8+3-1=10，24/10=2.4，D</span></p></li><li><p><span>指令流水线中出现数据相关时流水线將受阻，（）可解决数据相关问题。</span>
<span>A.增加硬件资源</span>
<span>B. 采用旁路技术</span>
<span>C. 采用分支预测技术</span>
<span>D.以上都可以</span></p><p><span>【答案】：D-&gt;B</span></p></li><li><p><span>下西有关控制相关的描述中，错误的是()</span>
<span>A. 条件转移指令可能引起控制相关</span>
<span>B. 在分支指令加入若千空操作可以避免控制冒险</span>
<span>C．采用转发（旁路）技术，可以解决部分控制相关</span>
<span>D.通过编译器调整指令执行顺序可解决部分控制冒险</span></p><p><span>【答案】：C</span></p></li><li><p><span>关于流水线技术的说法中，错误的是(）。</span>
<span>A. 超标量技术需要配置多个功能部件和指令译码电路等</span>
<span>B. 与超标量技术和超流水线技术相比，超长指令字技术对优化编译器要求更高，而无其他硬件要求</span>
<span>C.流水线按序流动时，在RAW、 WAR 和WAW 中，只可能出现RAW 相关</span>
<span>D.超流水线技术相当于将流水线再分段，从而提高每个周期内功能部件的使用次数</span></p><p><span>【答案】：B</span></p></li><li><p><span>【2009 统考真题】某计算机的指令流水线由 4 个功能段组成，指令流经各功能段的时间（忽略各功能段之问的缓存时间）分别为 9Ons、 80ns、70ns 和60ns，则该计算机的CPU周期至少是（）。</span>
<span>A. 90ns</span>
<span>B. 80ns</span>
<span>C. 7Ons</span>
<span>D. 60ns</span></p><p><span>【答案】：A</span></p></li><li><p><span>【2010 统考真题】下列不会引起指令流水线阻塞的是（）。</span>
<span>A.数据旁路</span>
<span>B.数据相关</span>
<span>C.条件转移</span>
<span>D.资源冲突</span></p><p><span>【答案】：A</span></p></li><li><p><span>【2013统考真题】某 CPU 主频为 1.03GHz，来用</span><strong><span>4 级</span></strong><span>指令流水线，每个流水段的执行需要1个时钟周期。假定CPU 执行了 100 条指令，在其执行过程中，没有发生任何流水线阻塞，此时流水线的吞吐率为（）。</span>
<span>A. 0.25x10^9 条指令/秒</span>
<span>B. 0.97x10^9条指令/秒</span>
<span>C. 1.0x10^9条指令/秒</span>
<span>D. 1.03x10^9 条指令/秒</span></p><p><span>【答案】：100+4-1=103，100/103x1.03=C</span></p></li><li><p><span>【2016 统考真题】在无转发机制的</span><strong><span>五段</span></strong><span>基本流水线（取指、译码/读寄存器、运算、访写回寄存器）中，下列指令序列存在数据冒险的指令对是（ ）</span>
<span>I1: add R1, R2, R3; (R2) + (R3) -&gt;R1</span>
<span>I2: add R5. R2. R4: (R2) + (R4)-&gt;R5</span>
<span>I3: add R4, R5, R3; (R5) + (R3)-&gt;R4</span>
<span>I4: add R5, R2, R6: (R2) + (R6)-&gt;R5</span>
<span>A. I1和I2</span>
<span>B. I2和I3</span>
<span>C. I2和I4</span>
<span>D. I3和I4</span></p><p><span>【答案】：B</span></p></li><li><p><span>【2017 统考真题】下列关于超标量流水线特性的叙述中，正确的是（ ）</span>
<span>I.能缩短流水线功能段的处理时间</span>
<span>II.能在一个时钟周期内同时发射多条指令</span>
<span>III. 能结合动态调度技术提高指令执行并行性</span>
<span>A.仅II</span>
<span>B.仅I、III</span>
<span>C仅II、III</span>
<span>D. I. II 和 III</span></p><p><span>【答案】：C</span></p></li><li><p><span>【2017 统考真题】下列关于指令流水线</span><u><span>数据通路</span></u><span>的叙述中，错误的是(〕</span>
<span>A.包含生成控制信号的控制部件</span>
<span>B. 包含算术逻拜运算部件(ALU)</span>
<span>C．包含通用寄存器组和取指部件</span>
<span>D.由组合逻辑电路和时序逻辑电路组合而成</span></p><p><span>【答案】：D-&gt;A</span></p></li><li><p><span>【2018 统考真题】若莱计第机最复杂指令的执行需要完成5个子功能，分别由功能部件A~E实现，各功能部件所需时问分别为 80ps、 50ps、 50ps、 70ps 和50ps， 来用流水线方式执行指令，流水段寄存器延时为20ps，则CPU 时钟周期至少为（）。</span>
<span>A. 60ps</span>
<span>B. 70ps</span>
<span>C. 80ps</span>
<span>D. 100ps</span></p><p><span>【答案】：D</span></p></li><li><p><span>【2019统考真题】在来用“取指、译码/取数、执行、访存、写回” 5段流水线的处理器中，执行如下指令序列，共中s0、s1、s2、s3 和t2表示寄存器编号</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="c"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="c"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 14px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">I1</span>: <span class="cm-variable">add</span> <span class="cm-variable">s2</span>, <span class="cm-variable">s1</span>, <span class="cm-variable">s0</span> &nbsp; <span class="cm-comment">//R[s2] &lt;-R[s1] +R[s0]</span></span></pre></div><div class="" style="position: relative;"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">I2</span>: <span class="cm-variable">load</span> <span class="cm-variable">s3</span>,<span class="cm-number">0</span> (<span class="cm-variable">t2</span>) &nbsp; <span class="cm-comment">//R[s3] &lt;-M[R[t2]+0]</span></span></pre></div><div class="" style="position: relative;"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">I3</span>: <span class="cm-variable">add</span> <span class="cm-variable">s2</span>, <span class="cm-variable">s2</span>, <span class="cm-variable">s3</span> &nbsp;<span class="cm-comment">//R[s2] &lt;- R[s2] +R[s3]</span></span></pre></div><div class="" style="position: relative;"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">I4</span>: <span class="cm-variable">store</span> <span class="cm-variable">s2</span>,<span class="cm-number">0</span> (<span class="cm-variable">t2</span>) <span class="cm-comment">//M[R[t2]+0] &lt;- R[s2]</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 128px;"></div><div class="CodeMirror-gutters" style="display: none; height: 128px;"></div></div></div></pre><p><span>下列指令对中，不存在数据冒险的是（ ）.</span>
<span>A. I1 和I3</span>
<span>B. I2和I3</span>
<span>C. I2 和I4</span>
<span>D. I3和14</span></p><p><span>【答案】：C</span></p></li><li><p><span>【2020 统考真题】下列给出的处理器类型中，理想情况下，CPI为1的是（）。</span></p><p><span>I. 单周期CPU II. 多周期CPU III. 基本流水线CPU IV. 超标量流水线 CPU</span>
<span>A. 仅I、II</span>
<span>B. 仅I、III</span>
<span>C. 仅II、IV</span>
<span>D. 仅III、IV</span></p><p><span>【答案】：D-&gt;B</span></p></li></ol></div></div>
</body>
</html>
# 移动IP

2022.3.12

[toc]

## 移动IP的概念

<u>支持移动性的因特网体系结构与协议共称为移动IP</u>，它是为了满足移动结点(计算机、服务器、网段等）在移动中保持其连接性而设计的。更确切地说，移动IP技术是指移动结点以固定的网络IP地址实现跨越不同网段的漫游功能，并保证基于网络IP的网络权限在漫游过程中不发生任何改变。移动IP的目标是把分组自动地投递给移动结点。一个移动结点是把其连接点从一个网络或子网改变到另一个网络或子网的主机。使用移动IP，一个移动结点可以在不改变其IP地址的情况下改变其驻留位置。

基于 IPv4 的移动 卫定义三种功能实体：**移动结点**、**归属代理**（也称本地代理）和**外埠代理**(也称外部代理）。归属代理和外埠代理又统称为移动代理。

* 移动结点。具有永久IP地址的移动结点。
* 本地代理。在一个网络环境中，一个移动结点的永久“居所”被称为归属网络，在归属网络中代表移动结点执行移动管理功能的实体称为归属代理（本地代理），它根据移动用广的转交地址，采用隧道技术转交移动结点的数据包。
* 外部代理。在外部网络中帮助移动结点完成移动管理功能的实体称为外部代理。

移动IP 和 移动自组网络 并不相同，移动IP技术使漫游的主机可以用多种方式连接到因特网，移动IP的核心网络功能仍然是基于固定互联网中一直使用的各种路由选择协议，移动自组网络是将移动性扩展到无线领域中的自治系统，它具有自己独特的路由选择协议，并且可以不和因特网相连。

移动IP 与 动态IP 是两个完全不同的概念，动态 IP 指的是局域网中的计算机可以通过网络中的 DHCP 服务器动态地获得一个IP地址，而不需要用户在计算机的网络设置中指定IP地址，动态IP和DHCP 经常会应用在我们的实际工作环境中。

## 移动IP的通信过程

在移动IP中，每个移动结点都有一个唯一的本地地址，当移动结点移动时，它的本地地址是不变的，在本地网络链路上每个移动结点还必须有一个本地代理来为它维护当前的位置信息，这就需要引入**转交地址**。当移动结点连接到外地网络链路上时，转交地址就用来标识移动结点现在所处的位置，以便进行路由选择。移动结点的本地地址与当前转交地址的联合称为移动绑定或简称鄉定。当移动结点得到一个新的转交地址时，通过维定向本地代理进行注册，以便让本地代理即时了解移动结点的当前位置。

移动IP技术的基本通信流程如下：
1）移动结点在本地网时，按传统的TCP/IP 方式进行通信（在本地网中有固有的地址）。

2）移动结点漫游到一个外地网络时，仍然使用固定的 IP 地址进行通信。为了能够收到通信对端发给它的 IP 分组，移动结点需要向本地代理注册当前的位置地址，这个位置地址就是转交地址（它可以是外部代理的地址或动态配置的一个地址）。

3）本地代理接收来自转交地址的注册后，会构建一条通向转交地址的隧道，将截获的发给移动结点的 卫 分组通过隧道送到转交地址处。

4）在转交地址处解除隧道封装，恢复原始的IP 分组，最后送到移动结点，这样移动结点在外网就能够收到这些发送给它的P分组。

5)移动结点在外网通过外网的路由器或外部代理向通信对端发送P数据包。

6)移动结点来到另一个外网时，只需向本地代理更新注册的转交地址，就可继续通信。

7)移动结点回到本地网时，移动结点向本地代理注销转交地址，这时移动结点又将使用传统的TCP/IP方式进行通信。

移动P为移动主机设置了两个P地址，即主地址和辅地址（转交地址）。移动主机在本地网时，使用的是主地址。当移动到另一个网络时，需要获得一个临时的辅地址，但此时主地址仍然不变。从外网移回本地网时，辅地址改变或撤销，而主地址仍然保持不变。

01.以下关于移动IP基本工作原理的描述中，错误的是（C）。

A. 移动P的基本工作过程可以分为代理发现、注册、分组路由与注销4个阶段

B. 结点在使用移动IP进行通信时，归属代理和外部代理之间需要建立一条隧道

C. 移动结点到达新的网络后，通过注册过程把自己新的可达信息通知外部代理

D. 移动P的分组路由可以分为单播、广播与组播

02.一台主机移动到了另一个LAN中，如果一个分组到达了它原来所在的LAN中，那么分组会被转发给（A）。

A.移动IP的本地代理

B.移动P的外部代理

C.主机

D.丢弃

03.移动P为移动主机设置了两个P地址：主地址和辅地址，(C)。

A.这两个地址都是固定的

B.这两个地址随主机的移动而动态改变

C.主地址固定，辅地址动态改变

D.主地址动态改变，辅地址固定

04.如果一台主机的P地址为160.80.40.20/16，那么当它移动到了另一个不属于160.80/16子网的网络中时，它将（B)。

A. 可以直接接收和直接发送分组，没有任何影响

B. 既不可以直接接收分组，也不可以直接发送分组

C. 不可以直接发送分组，但可以直接接收分组

D. 可以直接发送分组，但不可以直接接收分组
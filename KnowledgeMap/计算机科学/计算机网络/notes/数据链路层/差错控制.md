# 差错控制

2022.3.9

[toc]

## 奇偶校验码

奇偶校验码是**奇校验码**和**偶校验码**的统称,是一种最基本的检错码。它由**n-1位信息元和1位校验元**组成,如果是**奇校验码**,那么在**附加一个校验元**后,码长为n的码字中**“1”的个数为奇数**;如果是**偶校验码**,那么在**附加一个校验元**以后,码长为n的码字中**“1”的个数为偶数**。它只能检测奇数位的出错情况,但并不知道哪些位错了,也**不能发现偶数位的出错**情况。

## 循环冗余码（CRC）

1. 原料
   1. 帧/报文（m bit）
   2. 帧检验序列（r bit）
   3. 多项式（**最高位最低位必须是1**），注意从x的零次方开始！
   
2. 生成循环冗余码
   1. 帧除以多项式（**k**位），帧低位补0（**k-1**位）
   
   2. **模2除**
   
   3. 发送待传数据+FCS（**k-1**位）
   
      ![img](resources/图片1.png)

   > 使用举例：
   >
   > 题目：要发送的数据是 1101 0110 11，采用CRC检验，生成多项式是10011（x^4+0+0+x+1），最终发送的数据是？
   >
   > 方法：生成多项式10011五个数->补四个零在要发送的数据后边。摩二除生成多项式，得到的余数拼在要发送数据的后边。
   
3. 接收端检验

   1. 收到的数据除以多项式，余数为0则接收

   2. **n**位FCS可以检测出**n**位错误

      ![img](resources/图片2.png)

## 海明码

1. 码距与海明距离

   1. 码距：**不同的⽐特数**，⽐如**001与000**，码距为**1**。

      > 我的理解：
      >
      > 就是码距就是不同的编码的距离，如果码距是1，就说明传错⼀位就成了别的字符的编码。如果码距是2，传错⼀位，就啥也不是，就可以判断出传错了

   2. 海明距离：对于⼀个字符集来说，**所有**两个编码的**码距**取**最⼩值**。

   3. **检验d**位错误，码距需要**d+1**；**纠正d**位错误，码距需要**2d+1**。

2. 确定海明码位数(信息n位，校验k位)

   > 我的理解：
   >
   > 校验k位可以有2^k种组合，组合种类数量需要⽐总位数n+k多，这样就可以代表哪⼀位错了
   
   $$
   n+k+1≤2^k
   $$
   
3. 确定校验码位置
   $$
   \begin{align}
   信息位&: D_4D_3D_2D_1\\
   校验位&: P_3P_2P_1\\
   海明码&: H_7H_6H_5H_4H_3H_2H_1\\
   校验码插入位置&: H_{2^{n-1}}=P_n\\
   海明码&: D_4D_3D_2\textbf{P}_3D_1\textbf{P}_2\textbf{P}_1
   \end{align}
   $$
   
4. 检验关系（注意**最低位是1**，不是**0**,通常采⽤**偶校验**）

| 111  | 110  | 101  | 100  | 011  | 010   | 001  |
| ---- | ---- | ---- | ---- | ---- | ----- | ---- |
| H4   | H3   | H2   | P3   | H1   | P2    | P1   |
|      |      |      | 1**  |      | \*1\* | **1  |
| 1    | 1    | 0    | 0    | 0    | 0     | 1    |

$$
偶校验\{H_4(111)+H_3(110)+H_2(101)+P_3(100)\}=0\\
偶校验\{H_4(111)+H_3(110)+H_1(011)+P_2(010)\}=0\\
偶校验\{H_4(111)+H_2(101)+H_2(011)+P_1(001)\}=0
$$

5. 检错纠错

| 111  | 110   | 101  | 100  | 011  | 010  | 001  |
| ---- | ----- | ---- | ---- | ---- | ---- | ---- |
| H4   | H3    | H2   | P3   | H1   | P2   | P1   |
| 1    | **0** | 0    | 0    | 0    | 0    | 1    |

$$
P_3 = 偶校验\{H_4(111)+H_3(110)+H_2(101)+P_3(100)\}\overset{失败}=1\\
P_2 = 偶校验\{H_4(111)+H_3(110)+H_1(011)+P_2(010)\}\overset{失败}=1\\
P_1 = 偶校验\{H_4(111)+H_2(101)+H_2(011)+P_1(001)\}\overset{成功}=0
$$

不是全0，说明有错
$$
[P_3,P_2,P_1]=[1,1,0]\to 6
$$

> 海明码小结：
>
> 1. **检验d**位错误，码距需要**d+1**；**纠正d**位错误，码距需要**2d+1**。
> 2. $n+k+1≤2^k$，n bit数据，需要k个冗余位
> 3. 检验：检测位插入$2^{i-1}$位置，（最右）代表“xx1”，偶校验
> 4. 纠错：偶校验成功=0。[P3,P2,P1]

